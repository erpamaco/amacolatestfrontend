(this["webpackJsonpmatx-react"]=this["webpackJsonpmatx-react"]||[]).push([[243],{2526:function(e,t,a){"use strict";var n=a(19),c=a(0),r=a.n(c),l=a(2152),s=a(704),i=["palette"],m=Object(s.a)((function(e){e.palette,Object(n.a)(e,i);return{avatar:{height:"40px",width:"40px"},status_circle:{position:"absolute",height:"14px",width:"14px",borderRadius:"7px",bottom:"0px",right:"-3px",border:"2px solid white"}}}));t.a=function(e){var t=e.src,a=e.status,n=m();return r.a.createElement("div",{className:"relative"},r.a.createElement(l.a,{className:n.avatar,src:t}),r.a.createElement("div",{className:"".concat(n.status_circle," ").concat("online"===a?"bg-primary":"bg-error")}))}},2611:function(e,t,a){"use strict";a.d(t,"c",(function(){return r})),a.d(t,"d",(function(){return l})),a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return i})),a.d(t,"e",(function(){return m}));var n=a(26),c=a.n(n),r=function(e){return c.a.get("/api/chat/contacts",{data:e})},l=function(e){return c.a.get("/api/chat/contacts/recent",{data:e})},s=function(e){return c.a.get("/api/chat/contacts/all",{data:e})},i=function(e,t){return c.a.get("/api/chat/chat-room",{data:{currentUser:e,contactId:t}})},m=function(e){return c.a.post("/api/chat/add",e)}},3607:function(e,t,a){"use strict";a.r(t);var n=a(13),c=a(7),r=a(18),l=a(0),s=a.n(l),i=a(1385),m=a(1389),u=a(104),o=a(2611),d=a(19),p=a(2526),b=a(2365),f=a.n(b),h=a(2122),v=a(2116),E=a(704),g=a(5),j=["palette"],x=Object(E.a)((function(e){e.palette,Object(d.a)(e,j);return{chatSidenav:{borderRight:"1px solid rgba(0, 0, 0, 0.08)",height:450}}})),O=function(e){var t=e.currentUser,a=e.contactList,n=void 0===a?[]:a,c=e.recentContactList,r=void 0===c?[]:c,l=e.handleContactClick,i=x();return s.a.createElement("div",{className:Object(g.default)("bg-default",i.chatSidenav)},s.a.createElement("div",{className:"chat-sidenav__topbar flex items-center h-56 px-4 bg-primary"},s.a.createElement(p.a,{src:t.avatar,status:t.status}),s.a.createElement("h5",{className:"ml-4 whitespace-pre mb-0 font-medium text-18 text-white"},t.name)),s.a.createElement(f.a,{className:"relative h-full"},r.map((function(e,t){return s.a.createElement("div",{onClick:function(){return l(e.id)},key:t,className:"flex items-center p-4 cursor-pointer  gray-on-hover"},s.a.createElement(p.a,{src:e.avatar,status:e.status}),s.a.createElement("div",{className:"pl-4"},s.a.createElement("p",{className:"m-0"},e.name),s.a.createElement("p",{className:"m-0 text-muted"},Object(v.a)(new Date(e.lastChatTime).getTime(),"MMMM dd, yyyy"))))})),s.a.createElement(h.a,null),n.map((function(e,t){return s.a.createElement("div",{onClick:function(){return l(e.id)},key:t,className:"flex items-center px-4 py-1 cursor-pointer  gray-on-hover"},s.a.createElement(p.a,{src:e.avatar,status:e.status}),s.a.createElement("div",{className:"pl-4"},s.a.createElement("p",null,e.name)))}))))},N=a(1477),y=a(691),w=a(1449),C=a(1684),S=a(613),k=a(2167),_=["palette"],I=Object(E.a)((function(e){e.palette,Object(d.a)(e,_);return{icon:{fontSize:"4rem"}}})),L=function(){var e=I();return s.a.createElement("div",{className:"h-220 w-220 rounded elevation-z6 bg-default flex justify-center items-center"},s.a.createElement(w.a,{className:e.icon,color:"primary"},"chat"))},U=a(133),M=a(2594),D=a.n(M),R=["palette"],T=Object(E.a)((function(e){e.palette,Object(d.a)(e,R);return{chatContainer:{background:"rgba(0, 0, 0, 0.05)",height:450}}})),z=function(e){var t=e.id,a=e.toggleSidenav,n=e.currentChatRoom,c=e.opponentUser,i=e.messageList,m=void 0===i?[]:i,o=e.handleMessageSend,d=Object(l.useState)(""),b=Object(r.a)(d,2),v=b[0],E=b[1],j=T();return s.a.createElement("div",{className:Object(g.default)("flex-column relative",j.chatContainer)},s.a.createElement("div",{className:"chat-container__topbar flex items-center justify-between p-1 bg-primary"},s.a.createElement("div",{className:"flex items-center"},s.a.createElement(N.a,{mdUp:!0},s.a.createElement(y.a,{onClick:a},s.a.createElement(w.a,{className:"text-white"},"short_text"))),s.a.createElement(N.a,{smDown:!0},s.a.createElement("div",{className:"pl-3"})),c&&s.a.createElement(l.Fragment,null,s.a.createElement(p.a,{src:c.avatar,status:c.status}),s.a.createElement("h5",{className:"ml-4 whitespace-pre mb-0 font-medium text-18 text-white"},c.name))),s.a.createElement(u.n,{menuButton:s.a.createElement(y.a,null,s.a.createElement(w.a,{className:"text-white"},"more_vert"))},s.a.createElement(C.a,{className:"flex items-center"},s.a.createElement(w.a,{className:"mr-4"},"account_circle")," Contact"),s.a.createElement(C.a,{className:"flex items-center"},s.a.createElement(w.a,{className:"mr-4"},"volume_mute")," Mute"),s.a.createElement(C.a,{className:"flex items-center"},s.a.createElement(w.a,{className:"mr-4"},"delete")," Clear Chat"))),s.a.createElement(f.a,{className:"chat-message-list flex-grow relative",id:"chat-message-list"},""===n&&s.a.createElement("div",{className:"flex-column justify-center items-center h-full"},s.a.createElement(L,null),s.a.createElement("p",null,"Select a contact")),m.map((function(e,a){return s.a.createElement("div",{className:"flex items-start px-4 py-3",key:D.a.generate()},s.a.createElement(p.a,{src:e.avatar,status:e.status}),s.a.createElement("div",{className:"ml-4"},s.a.createElement("p",{className:"text-muted m-0 mb-2"},e.name),s.a.createElement("div",{className:Object(g.default)({"px-4 py-2 mb-2 border-radius-4 bg-paper":!0,"bg-primary text-white":t===e.contactId})},s.a.createElement("span",{className:"whitespace-pre-wrap"},e.text)),s.a.createElement("small",{className:"text-muted mb-0"},Object(U.d)(new Date(e.time))," ago")))}))),s.a.createElement(h.a,null),""!==n&&s.a.createElement("div",{className:"flex items-center px-4 py-2"},s.a.createElement(S.a,{label:"Type your message here*",value:v,onChange:function(e){return E(e.target.value)},onKeyUp:function(e){if("Enter"===e.key&&!e.shiftKey){var t=v.trim();""!==t&&o(t),E("")}},fullWidth:!0,multiline:!0,rows:1,variant:"outlined"}),s.a.createElement("div",null,s.a.createElement(k.a,{onClick:function(){""!==v.trim()&&o(v),E("")},color:"primary",className:"ml-4"},s.a.createElement(w.a,null,"send")))))},q=a(61);t.default=function(){var e=document.querySelector("#chat-message-list"),t=Object(l.useState)(!0),a=Object(r.a)(t,2),d=a[0],p=a[1],b=Object(l.useState)({id:"7863a6802ez0e277a0f98534"}),f=Object(r.a)(b,2),h=f[0],v=f[1],E=Object(l.useState)(null),g=Object(r.a)(E,2),j=g[0],x=g[1],N=Object(l.useState)(""),y=Object(r.a)(N,2),w=y[0],C=y[1],S=Object(l.useState)([]),k=Object(r.a)(S,2),_=k[0],I=k[1],L=Object(l.useState)([]),U=Object(r.a)(L,2),M=U[0],D=U[1],R=Object(l.useState)([]),T=Object(r.a)(R,2),H=T[0],J=T[1],K=Object(l.useRef)(h),B=Object(q.a)(),F=Object(i.a)(B.breakpoints.down("sm")),W=Object(l.useCallback)((function(){var e=K.current.id;Object(o.d)(e).then((function(e){D(e.data)}))}),[]);Object(l.useEffect)((function(){var e=K.current.id;Object(o.c)(e).then((function(e){p(F),v(Object(c.a)({},e.data))})),Object(o.a)(h.id).then((function(e){return I(e.data)})),W()}),[F,h.id,W]);var Y=function(){e&&e.scrollTo({top:e.scrollHeight,behavior:"smooth"})},A=function(){p(!d)};return s.a.createElement("div",{className:"m-sm-30"},s.a.createElement("div",{className:"mb-sm-30"},s.a.createElement(u.b,{routeSegments:[{name:"Chat"}]})),s.a.createElement(m.a,{elevation:6},s.a.createElement(u.r,null,s.a.createElement(u.q,{width:"230px",open:d,toggleSidenav:A},s.a.createElement(O,{currentUser:h,contactList:_,recentContactList:M,handleContactClick:function(e){F&&A(),Object(o.c)(e).then((function(e){var t=e.data;x(Object(c.a)({},t))})),Object(o.b)(h.id,e).then((function(e){var t=e.data,a=t.chatId,n=t.messageList,c=t.recentListUpdated;C(a),J(n),Y(),c&&W()}))}})),s.a.createElement(u.s,null,s.a.createElement(z,{id:null===h||void 0===h?void 0:h.id,opponentUser:j,messageList:H,currentChatRoom:w,handleMessageSend:function(e){var t=h.id;""!==w&&(Object(o.e)({chatId:w,text:e,contactId:t,time:new Date}).then((function(e){J(Object(n.a)(e.data)),Y()})),setTimeout((function(){Object(o.e)({chatId:w,text:"Hi, I'm ".concat(j.name,". Your imaginary friend."),contactId:j.id,time:new Date}).then((function(e){J(Object(n.a)(e.data)),Y()}))}),750))},toggleSidenav:A})))))}}}]);